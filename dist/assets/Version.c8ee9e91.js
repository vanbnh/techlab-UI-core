import{l as v,r as d,y as O,e as h,W as b,j as u,bg as L,J as T,K as $,M as E}from"./index.87b97d19.js";import{u as F}from"./useQuery.beff949c.js";import{u as G,s as S}from"./NotFound.b3481f95.js";function M({keys:n,urls:m,columns:i}){const{t:x}=v(),{detail:f,setDetail:g,data:c,isLoading:l,notFound:D,versions:r}=G({columns:i,key:n.detail,url:m.detail}),[e,j]=d.exports.useState(0),[I,k]=d.exports.useState(!1),[w,C]=d.exports.useState(null),[N,V]=d.exports.useState(null),{data:a,isLoading:z}=F([n.version,e],async()=>await O.get(`${m.version}${e}/`).then(t=>t.data),{enabled:!!e}),y=x("Version ID");return d.exports.useEffect(()=>{r.length>0&&e&&k(r[0]!==e)},[r,e]),d.exports.useEffect(()=>{if(a!=null&&a.data){let t=S(a.data,i);t=Object.keys(t).reduce((o,s)=>(o[s]=t[s],o),{[y]:e}),g(t)}V(null),C(null)},[e,a]),{detail:f,versions:r,isLoading:l,notFound:D,isShowCompare:I,dataVersionCurrent:w,dataVersionCompare:N,isLoadingVersion:z,versionSelect:e,setVersionSelect:j,onSetDataVersionCompare:()=>{if(r.length>0&&e&&(a==null?void 0:a.data)&&c){let t=S(a.data,i,!0);t=Object.keys(t).reduce((s,p)=>(s[p]=t[p],{...s}),{[y]:e}),V(t);let o=S(c,i,!0);o=Object.keys(o).reduce((s,p)=>(s[p]=o[p],s),{[y]:String(r[0])}),C(o)}},onCancelCompare:()=>{j(r[0]),V(null),C(null)}}}const Q=({versions:n,isShowCompare:m,onSetDataVersionCompare:i,onCancelCompare:x,versionSelect:f,setVersionSelect:g})=>{const{t:c}=v();return h("div",{className:"d-flex justify-content-end align-items-center",children:[m&&n.length>0&&h("div",{className:"d-flex gx-0 me-1",children:[h(b,{color:"relief-primary",className:"me-50",size:"sm",onClick:i,children:[c("Compare with")," ",n[0]]}),u(b.Ripple,{className:"btn-icon",size:"sm",outline:!0,color:"secondary",onClick:x,children:u(L,{size:16})})]}),u("div",{style:{maxWidth:"240px"},children:n.length>0&&h(T,{children:[u($,{children:c("version")}),u(E,{type:"select",name:"version",id:"version",value:f,onChange:l=>g(l.target.value),children:n.map(l=>u("option",{children:l},l))})]})})]})};export{Q as V,M as u};
