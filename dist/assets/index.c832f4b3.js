import{r as u,a as c,j as e,p as m,a3 as N,a4 as T,k as L,a5 as j,a6 as O,a7 as A,A as E,a8 as P,L as _,a9 as k,aa as $,ab as R,ac as D,ad as U,ae as V,K as W,af as M,ag as q,ah as G,ai as H,aj as z}from"./index.945d01c7.js";import{E as K,a as X,u as Y,b as J,g as Q,c as Z,d as ee,e as se,A as ae,X as re}from"./App.dd14fcdf.js";import{u as ne,C as F}from"./index.esm.a6b64a4e.js";function te(s,n){if(s==null)return{};var t=oe(s,n),i,r;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);for(r=0;r<l.length;r++)i=l[r],!(n.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(s,i)||(t[i]=s[i]))}return t}function oe(s,n){if(s==null)return{};var t={},i=Object.keys(s),r,l;for(l=0;l<i.length;l++)r=i[l],!(n.indexOf(r)>=0)&&(t[r]=s[r]);return t}var C=u.exports.forwardRef(function(s,n){var t=s.color,i=t===void 0?"currentColor":t,r=s.size,l=r===void 0?24:r,h=te(s,["color","size"]);return c("svg",{ref:n,xmlns:"http://www.w3.org/2000/svg",width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...h,children:[e("path",{d:"M18 8h1a4 4 0 0 1 0 8h-1"}),e("path",{d:"M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"}),e("line",{x1:"6",y1:"1",x2:"6",y2:"4"}),e("line",{x1:"10",y1:"1",x2:"10",y2:"4"}),e("line",{x1:"14",y1:"1",x2:"14",y2:"4"})]})});C.propTypes={color:m.exports.string,size:m.exports.oneOfType([m.exports.string,m.exports.number])};C.displayName="Coffee";const ie=C,B=u.exports.forwardRef((s,n)=>{const{label:t,hideIcon:i,showIcon:r,visible:l,className:h,htmlFor:p,placeholder:v,iconSize:f,inputClassName:g,invalid:y,...w}=s,[b,o]=u.exports.useState(l),d=()=>{const a=f||14;return b===!1?i||e(K,{size:a}):r||e(X,{size:a})};return c(u.exports.Fragment,{children:[t?e(N,{className:"form-label",for:p,children:t}):null,c(T,{className:L({[h]:h,"is-invalid":y}),children:[e(j,{ref:n,invalid:y,type:b===!1?"password":"text",placeholder:v||"\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7",className:L({[g]:g}),...t&&p?{id:p}:{},...w}),e(O,{className:"cursor-pointer",onClick:()=>o(!b),children:d()})]})]})});B.propTypes={invalid:m.exports.bool,hideIcon:m.exports.node,showIcon:m.exports.node,visible:m.exports.bool,className:m.exports.string,placeholder:m.exports.string,iconSize:m.exports.number,inputClassName:m.exports.string,label(s,n){if(s[n]&&s.htmlFor==="undefined")throw new Error("htmlFor prop is required when label prop is present")},htmlFor(s,n){if(s[n]&&s.label==="undefined")throw new Error("label prop is required when htmlFor prop is present")}};B.defaultProps={visible:!1};const le="/assets/login-v2.f073f8a2.svg",ce="/assets/login-v2-dark.28044871.svg";const I=ee(),me=({t:s,name:n,role:t})=>c("div",{className:"d-flex",children:[e("div",{className:"me-1",children:e(ae,{size:"sm",color:"success",icon:e(ie,{size:12})})}),c("div",{className:"d-flex flex-column",children:[c("div",{className:"d-flex justify-content-between",children:[e("h6",{children:n}),e(re,{size:12,className:"cursor-pointer",onClick:()=>z.dismiss(s.id)})]}),c("span",{children:["You have successfully logged in as an ",t," user to ",I,". Now you can start to explore. Enjoy!"]})]})]}),de={username:"",password:""},fe=()=>{const{skin:s}=Y(),n=J(),t=A(),i=u.exports.useContext(E),{control:r,setError:l,handleSubmit:h,formState:{errors:p}}=ne({defaultValues:de}),[v,f]=u.exports.useState(!1),[g,y]=u.exports.useState(null);u.exports.useEffect(()=>{g&&t(Q(g.role))},[g]);const w=s==="dark"?ce:le,b=o=>{if(Object.values(o).every(d=>d.length>0))f(!0),G.login({username:o.username,password:o.password}).then(d=>{const a=d.data,x={role:"admin",fullName:(a==null?void 0:a.first_name)&&(a==null?void 0:a.last_name)?`${a==null?void 0:a.first_name} ${a==null?void 0:a.last_name}`:(a==null?void 0:a.username)||"Admin",avatar:se(),ability:[{action:"manage",subject:"all"}],accessToken:a.access,refreshToken:a.refresh};n(H(x)),i.update(x.ability),f(!1),y(x),z(S=>e(me,{t:S,role:o.role||"admin",name:o.fullName||o.username||"Admin"}))}).catch(d=>{var a,x;console.log(d),f(!1),l("username",{type:"manual",message:(x=(a=d.response)==null?void 0:a.data)==null?void 0:x.error})});else for(const d in o)o[d].length===0&&l(d,{type:"manual"})};return e("div",{className:"auth-wrapper auth-cover",children:c(P,{className:"auth-inner m-0",children:[e(_,{className:"brand-logo",to:"/",onClick:o=>o.preventDefault(),children:e("img",{className:"img-fluid",width:"300",src:Z()})}),e(k,{className:"d-none d-lg-flex align-items-center p-5",lg:"8",sm:"12",children:e("div",{className:"w-100 d-lg-flex align-items-center justify-content-center px-5",children:e("img",{className:"img-fluid",src:w,alt:"Login Cover"})})}),e(k,{className:"d-flex align-items-center auth-bg px-2 p-lg-5",lg:"4",sm:"12",children:c(k,{className:"px-xl-2 mx-auto",sm:"8",md:"6",lg:"12",children:[c($,{tag:"h2",className:"fw-bold mb-1",children:["Welcome to ",I,"! \u{1F44B}"]}),e(R,{className:"mb-2",children:"Please sign-in to your account and start the adventure"}),e(D,{color:"primary"}),c(U,{className:"auth-login-form mt-2",onSubmit:h(b),children:[c("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"login-email",children:"Username"}),e(F,{id:"username",name:"username",control:r,render:({field:o})=>e(j,{autoFocus:!0,placeholder:"Username",invalid:p.username&&!0,...o})}),p.username&&e(V,{children:p.username.message})]}),c("div",{className:"mb-1",children:[e("div",{className:"d-flex justify-content-between",children:e(N,{className:"form-label",for:"login-password",children:"Password"})}),e(F,{id:"password",name:"password",control:r,render:({field:o})=>e(B,{className:"input-group-merge",invalid:p.password&&!0,...o})})]}),c("div",{className:"form-check mb-1",children:[e(j,{type:"checkbox",id:"remember-me"}),e(N,{className:"form-check-label",for:"remember-me",children:"Remember Me"})]}),e(W,{type:"submit",color:"primary",block:!0,children:v?c(M,{children:[e(q,{color:"white",size:"sm"}),e("span",{className:"ms-50",children:"Loading..."})]}):"Sign in"})]})]})})]})})};export{fe as default};
