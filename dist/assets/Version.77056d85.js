import{r as d,a1 as N,a as h,K as y,j as u,a4 as z,a6 as I,a5 as O}from"./index.945d01c7.js";import{u as L}from"./useQuery.ad367fe6.js";import{u as $,s as V}from"./NotFound.024f1b9d.js";import{X as E}from"./App.dd14fcdf.js";function R({keys:s,urls:p,columns:o}){const{detail:f,setDetail:x,data:m,isLoading:l,notFound:v,versions:r}=$({columns:o,key:s.detail,url:p.detail}),[e,S]=d.exports.useState(0),[j,b]=d.exports.useState(!1),[k,C]=d.exports.useState(null),[w,g]=d.exports.useState(null),{data:a,isLoading:D}=L([s.version,e],async()=>await N.get(`${p.version}${e}/`).then(t=>t.data),{enabled:!!e});return d.exports.useEffect(()=>{r.length>0&&e&&b(r[0]!==e)},[r,e]),d.exports.useEffect(()=>{if(a!=null&&a.data){let t=V(a.data,o);t=Object.keys(t).reduce((i,n)=>(i[n]=t[n],i),{"version id":e}),x(t)}g(null),C(null)},[e,a]),{detail:f,versions:r,isLoading:l,notFound:v,isShowCompare:j,dataVersionCurrent:k,dataVersionCompare:w,isLoadingVersion:D,versionSelect:e,setVersionSelect:S,onSetDataVersionCompare:()=>{if(r.length>0&&e&&(a==null?void 0:a.data)&&m){let t=V(a.data,o,!0);t=Object.keys(t).reduce((n,c)=>(n[c]=t[c],{...n}),{"version id":e}),g(t);let i=V(m,o,!0);i=Object.keys(i).reduce((n,c)=>(n[c]=i[c],n),{"version id":String(r[0])}),C(i)}},onCancelCompare:()=>{S(r[0]),g(null),C(null)}}}const T=({versions:s,isShowCompare:p,onSetDataVersionCompare:o,onCancelCompare:f,versionSelect:x,setVersionSelect:m})=>h("div",{className:"d-flex justify-content-end align-items-center",children:[p&&s.length>0&&h("div",{className:"d-flex gx-0 me-1",children:[h(y,{color:"relief-primary",className:"me-50",size:"sm",onClick:o,children:["Compare with v.",s[0]]}),u(y.Ripple,{className:"btn-icon",size:"sm",outline:!0,color:"secondary",onClick:f,children:u(E,{size:16})})]}),u("div",{style:{maxWidth:"240px"},children:s.length>0&&h(z,{children:[u(I,{children:"version"}),u(O,{type:"select",name:"version",id:"version",value:x,onChange:l=>m(l.target.value),children:s.map(l=>u("option",{children:l},l))})]})})]});export{T as V,R as u};
