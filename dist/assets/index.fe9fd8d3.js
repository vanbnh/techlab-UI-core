import{bc as j,o as C,d as F,q as I,r as o,bd as T,a8 as A,c as D,j as e,e as t,R as P,a1 as R,be as _,J as d,aL as $,O as B,aa as U,L as g,ab as h,Z as f,aI as E,bf as O,W,F as q,a4 as z,bg as H,bh as J,bi as M,aP as V}from"./index.09cac9f7.js";const Z="/assets/login-v2.f073f8a2.svg",G="/assets/login-v2-dark.28044871.svg";const K={username:"",password:""},X=()=>{const{skin:b}=j(),{t:n}=C(),p=F(),N=I(),v=o.exports.useContext(T),{control:u,setError:x,handleSubmit:w,formState:{errors:l}}=A({defaultValues:K}),[k,i]=o.exports.useState(!1),[c,L]=o.exports.useState(null);o.exports.useEffect(()=>{c&&N(D(c.role))},[c]);const y=b==="dark"?G:Z,S=s=>{if(Object.values(s).every(r=>r.length>0))i(!0),H.login({username:s.username,password:s.password}).then(r=>{const a=r.data,m={role:"admin",fullName:(a==null?void 0:a.first_name)&&(a==null?void 0:a.last_name)?`${a==null?void 0:a.first_name} ${a==null?void 0:a.last_name}`:(a==null?void 0:a.username)||"Admin",avatar:J(),ability:[{action:"manage",subject:"all"}],accessToken:a.access,refreshToken:a.refresh};p(M(m)),v.update(m.ability),i(!1),L(m)}).catch(r=>{i(!1),V.error(n("Login failed"))});else for(const r in s)s[r].length===0&&x(r,{type:"manual"})};return e("div",{className:"auth-wrapper auth-cover",children:t(P,{className:"auth-inner m-0",children:[e(R,{className:"brand-logo",to:"/",onClick:s=>s.preventDefault(),children:e("img",{className:"img-fluid",width:"300",src:_()})}),e(d,{className:"d-none d-lg-flex align-items-center p-5",lg:"8",sm:"12",children:e("div",{className:"w-100 d-lg-flex align-items-center justify-content-center px-5",children:e("img",{className:"img-fluid",src:y,alt:"Login Cover"})})}),e(d,{className:"d-flex align-items-center auth-bg px-2 p-lg-5",lg:"4",sm:"12",children:t(d,{className:"px-xl-2 mx-auto",sm:"8",md:"6",lg:"12",children:[e($,{tag:"h2",className:"fw-bold mb-1",children:n("Welcome!")}),e(B,{className:"mb-2",children:n("Insert your email and password to login!")}),t(U,{className:"auth-login-form mt-2",onSubmit:w(S),children:[t("div",{className:"mb-1",children:[e(g,{className:"form-label",for:"login-email",children:n("Username")}),e(h,{id:"username",name:"username",control:u,render:({field:s})=>e(f,{autoFocus:!0,invalid:l.username&&!0,...s})}),l.username&&e(E,{children:l.username.message})]}),t("div",{className:"mb-1",children:[e("div",{className:"d-flex justify-content-between",children:e(g,{className:"form-label",for:"login-password",children:n("Password")})}),e(h,{id:"password",name:"password",control:u,render:({field:s})=>e(O,{className:"input-group-merge",invalid:l.password&&!0,...s})})]}),t("div",{className:"form-check mb-1",children:[e(f,{type:"checkbox",id:"remember-me"}),e(g,{className:"form-check-label",for:"remember-me",children:n("Remember Me")})]}),e(W,{type:"submit",color:"primary",block:!0,children:k?t(q,{children:[e(z,{color:"white",size:"sm"}),e("span",{className:"ms-50",children:n("Loading...")})]}):n("Sign In")})]})]})})]})})};export{X as default};
