import{bb as S,o as j,d as C,q as I,r as o,bc as T,a8 as B,c as D,j as e,e as t,R as P,a1 as A,bd as R,J as d,aL as _,O as $,aa as U,L as u,ab as h,Z as f,aI as E,be as M,W as O,F as W,a4 as q,bf as z,bg as G,bh as H,aP as J}from"./index.4ca943a0.js";const V="/assets/login-v2.f073f8a2.svg",Z="/assets/login-v2-dark.28044871.svg";const K={username:"",password:""},X=()=>{const{skin:b}=S(),{t:n}=j(),p=C(),N=I(),v=o.exports.useContext(T),{control:g,setError:x,handleSubmit:w,formState:{errors:l}}=B({defaultValues:K}),[k,i]=o.exports.useState(!1),[c,L]=o.exports.useState(null);o.exports.useEffect(()=>{c&&N(D(c.role))},[c]);const y=b==="dark"?Z:V,F=s=>{if(Object.values(s).every(r=>r.length>0))i(!0),z.login({username:s.username,password:s.password}).then(r=>{const a=r.data,m={role:"admin",fullName:(a==null?void 0:a.first_name)&&(a==null?void 0:a.last_name)?`${a==null?void 0:a.first_name} ${a==null?void 0:a.last_name}`:(a==null?void 0:a.username)||"Admin",avatar:G(),ability:[{action:"manage",subject:"all"}],accessToken:a.access,refreshToken:a.refresh};p(H(m)),v.update(m.ability),i(!1),L(m)}).catch(r=>{i(!1),J.error(n("Login failed"))});else for(const r in s)s[r].length===0&&x(r,{type:"manual"})};return e("div",{className:"auth-wrapper auth-cover",children:t(P,{className:"auth-inner m-0",children:[e(A,{className:"brand-logo",to:"/",onClick:s=>s.preventDefault(),children:e("img",{className:"img-fluid",width:"300",src:R()})}),e(d,{className:"d-none d-lg-flex align-items-center p-5",lg:"8",sm:"12",children:e("div",{className:"w-100 d-lg-flex align-items-center justify-content-center px-5",children:e("img",{className:"img-fluid",src:y,alt:"Login Cover"})})}),e(d,{className:"d-flex align-items-center auth-bg px-2 p-lg-5",lg:"4",sm:"12",children:t(d,{className:"px-xl-2 mx-auto",sm:"8",md:"6",lg:"12",children:[t(_,{tag:"h2",className:"fw-bold mb-1",children:[n("Welcome to GMB Dashboard"),"! \u{1F44B}"]}),e($,{className:"mb-2",children:n("Please sign-in to your account and start the adventure")}),t(U,{className:"auth-login-form mt-2",onSubmit:w(F),children:[t("div",{className:"mb-1",children:[e(u,{className:"form-label",for:"login-email",children:n("Username")}),e(h,{id:"username",name:"username",control:g,render:({field:s})=>e(f,{autoFocus:!0,invalid:l.username&&!0,...s})}),l.username&&e(E,{children:l.username.message})]}),t("div",{className:"mb-1",children:[e("div",{className:"d-flex justify-content-between",children:e(u,{className:"form-label",for:"login-password",children:n("Password")})}),e(h,{id:"password",name:"password",control:g,render:({field:s})=>e(M,{className:"input-group-merge",invalid:l.password&&!0,...s})})]}),t("div",{className:"form-check mb-1",children:[e(f,{type:"checkbox",id:"remember-me"}),e(u,{className:"form-check-label",for:"remember-me",children:n("Remember Me")})]}),e(O,{type:"submit",color:"primary",block:!0,children:k?t(W,{children:[e(q,{color:"white",size:"sm"}),e("span",{className:"ms-50",children:n("Loading...")})]}):n("Sign In")})]})]})})]})})};export{X as default};
