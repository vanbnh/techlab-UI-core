import{r as c,e as t,j as e,L as w,I as S,f as L,i as F,k as T,p as l,E as j,l as E,m as A,n as D,d as z,o as P,A as R,c as G,R as _,q as $,s as q,C as B,t as U,v as V,w as H,F as M,x as O,y as W,z as J,S as K,D as Q,G as X,H as Y}from"./index.bb0be26b.js";import{u as Z,C}from"./index.esm.4c0467c0.js";const I=c.exports.forwardRef((o,a)=>{const{label:p,hideIcon:x,showIcon:b,visible:N,className:h,htmlFor:g,placeholder:i,iconSize:v,inputClassName:m,invalid:d,...y}=o,[f,k]=c.exports.useState(N),r=()=>{const n=v||14;return f===!1?x||e(j,{size:n}):b||e(E,{size:n})};return t(c.exports.Fragment,{children:[p?e(w,{className:"form-label",for:g,children:p}):null,t(S,{className:L({[h]:h,"is-invalid":d}),children:[e(F,{ref:a,invalid:d,type:f===!1?"password":"text",placeholder:i||"\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7\xB7",className:L({[m]:m}),...p&&g?{id:g}:{},...y}),e(T,{className:"cursor-pointer",onClick:()=>k(!f),children:r()})]})]})});I.propTypes={invalid:l.exports.bool,hideIcon:l.exports.node,showIcon:l.exports.node,visible:l.exports.bool,className:l.exports.string,placeholder:l.exports.string,iconSize:l.exports.number,inputClassName:l.exports.string,label(o,a){if(o[a]&&o.htmlFor==="undefined")throw new Error("htmlFor prop is required when label prop is present")},htmlFor(o,a){if(o[a]&&o.label==="undefined")throw new Error("label prop is required when htmlFor prop is present")}};I.defaultProps={visible:!1};const ee="/assets/login-v2.f073f8a2.svg",se="/assets/login-v2-dark.28044871.svg";const ae={username:"",password:""},te=()=>{const{skin:o}=A(),{t:a}=D(),p=z(),x=P(),b=c.exports.useContext(R),{control:N,setError:h,handleSubmit:g,formState:{errors:i}}=Z({defaultValues:ae}),[v,m]=c.exports.useState(!1),[d,y]=c.exports.useState(null);c.exports.useEffect(()=>{d&&x(G(d.role))},[d]);const f=o==="dark"?se:ee,k=r=>{if(Object.values(r).every(n=>n.length>0))m(!0),Q.login({username:r.username,password:r.password}).then(n=>{const s=n.data,u={role:"admin",fullName:(s==null?void 0:s.first_name)&&(s==null?void 0:s.last_name)?`${s==null?void 0:s.first_name} ${s==null?void 0:s.last_name}`:(s==null?void 0:s.username)||"Admin",avatar:X(),ability:[{action:"manage",subject:"all"}],accessToken:s.access,refreshToken:s.refresh};p(Y(u)),b.update(u.ability),m(!1),y(u)}).catch(n=>{var s,u;console.log(n),m(!1),h("username",{type:"manual",message:(u=(s=n.response)==null?void 0:s.data)==null?void 0:u.error})});else for(const n in r)r[n].length===0&&h(n,{type:"manual"})};return e("div",{className:"auth-wrapper auth-cover",children:t(_,{className:"auth-inner m-0",children:[e($,{className:"brand-logo",to:"/",onClick:r=>r.preventDefault(),children:e("img",{className:"img-fluid",width:"300",src:q()})}),e(B,{className:"d-none d-lg-flex align-items-center p-5",lg:"8",sm:"12",children:e("div",{className:"w-100 d-lg-flex align-items-center justify-content-center px-5",children:e("img",{className:"img-fluid",src:f,alt:"Login Cover"})})}),e(B,{className:"d-flex align-items-center auth-bg px-2 p-lg-5",lg:"4",sm:"12",children:t(B,{className:"px-xl-2 mx-auto",sm:"8",md:"6",lg:"12",children:[t(U,{tag:"h2",className:"fw-bold mb-1",children:[a("Welcome to GMB Dashboard"),"! \u{1F44B}"]}),e(V,{className:"mb-2",children:a("Please sign-in to your account and start the adventure")}),e(H,{color:"primary"}),t(M,{className:"auth-login-form mt-2",onSubmit:g(k),children:[t("div",{className:"mb-1",children:[e(w,{className:"form-label",for:"login-email",children:a("Username")}),e(C,{id:"username",name:"username",control:N,render:({field:r})=>e(F,{autoFocus:!0,invalid:i.username&&!0,...r})}),i.username&&e(O,{children:i.username.message})]}),t("div",{className:"mb-1",children:[e("div",{className:"d-flex justify-content-between",children:e(w,{className:"form-label",for:"login-password",children:a("Password")})}),e(C,{id:"password",name:"password",control:N,render:({field:r})=>e(I,{className:"input-group-merge",invalid:i.password&&!0,...r})})]}),t("div",{className:"form-check mb-1",children:[e(F,{type:"checkbox",id:"remember-me"}),e(w,{className:"form-check-label",for:"remember-me",children:a("Remember Me")})]}),e(W,{type:"submit",color:"primary",block:!0,children:v?t(J,{children:[e(K,{color:"white",size:"sm"}),e("span",{className:"ms-50",children:a("Loading...")})]}):a("Sign In")})]})]})})]})})};export{te as default};
