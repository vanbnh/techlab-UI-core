import{by as S,l as j,d as F,m as B,r as o,bz as D,a7 as I,c as T,j as e,e as t,R as A,a0 as P,bA as R,z as d,b6 as _,G as $,a9 as z,L as u,aa as h,M as b,P as E,bB as M,W as U,I as G,a3 as W,bC as H,bD as O,bE as V,bb as q}from"./index.56ff64cc.js";const J="/assets/login-v2.f073f8a2.svg",K="/assets/login-v2-dark.28044871.svg";const Q={username:"",password:""},Y=()=>{const{skin:f}=S(),{t:n}=j(),p=F(),N=B(),v=o.exports.useContext(D),{control:g,setError:x,handleSubmit:w,formState:{errors:l}}=I({defaultValues:Q}),[k,i]=o.exports.useState(!1),[c,L]=o.exports.useState(null);o.exports.useEffect(()=>{c&&N(T(c.role))},[c]);const y=f==="dark"?K:J,C=s=>{if(Object.values(s).every(r=>r.length>0))i(!0),H.login({username:s.username,password:s.password}).then(r=>{const a=r.data,m={role:"admin",fullName:(a==null?void 0:a.first_name)&&(a==null?void 0:a.last_name)?`${a==null?void 0:a.first_name} ${a==null?void 0:a.last_name}`:(a==null?void 0:a.username)||"Admin",avatar:O(),ability:[{action:"manage",subject:"all"}],accessToken:a.access,refreshToken:a.refresh};p(V(m)),v.update(m.ability),i(!1),L(m)}).catch(r=>{i(!1),q.error(n("Login failed"))});else for(const r in s)s[r].length===0&&x(r,{type:"manual"})};return e("div",{className:"auth-wrapper auth-cover",children:t(A,{className:"auth-inner m-0",children:[e(P,{className:"brand-logo",to:"/",onClick:s=>s.preventDefault(),children:e("img",{className:"img-fluid",width:"300",src:R()})}),e(d,{className:"d-none d-lg-flex align-items-center p-5",lg:"8",sm:"12",children:e("div",{className:"w-100 d-lg-flex align-items-center justify-content-center px-5",children:e("img",{className:"img-fluid",src:y,alt:"Login Cover"})})}),e(d,{className:"d-flex align-items-center auth-bg px-2 p-lg-5",lg:"4",sm:"12",children:t(d,{className:"px-xl-2 mx-auto",sm:"8",md:"6",lg:"12",children:[t(_,{tag:"h2",className:"fw-bold mb-1",children:[n("Welcome to GMB Dashboard"),"! \u{1F44B}"]}),e($,{className:"mb-2",children:n("Please sign-in to your account and start the adventure")}),t(z,{className:"auth-login-form mt-2",onSubmit:w(C),children:[t("div",{className:"mb-1",children:[e(u,{className:"form-label",for:"login-email",children:n("Username")}),e(h,{id:"username",name:"username",control:g,render:({field:s})=>e(b,{autoFocus:!0,invalid:l.username&&!0,...s})}),l.username&&e(E,{children:l.username.message})]}),t("div",{className:"mb-1",children:[e("div",{className:"d-flex justify-content-between",children:e(u,{className:"form-label",for:"login-password",children:n("Password")})}),e(h,{id:"password",name:"password",control:g,render:({field:s})=>e(M,{className:"input-group-merge",invalid:l.password&&!0,...s})})]}),t("div",{className:"form-check mb-1",children:[e(b,{type:"checkbox",id:"remember-me"}),e(u,{className:"form-check-label",for:"remember-me",children:n("Remember Me")})]}),e(U,{type:"submit",color:"primary",block:!0,children:k?t(G,{children:[e(W,{color:"white",size:"sm"}),e("span",{className:"ms-50",children:n("Loading...")})]}):n("Sign In")})]})]})})]})})};export{Y as default};
